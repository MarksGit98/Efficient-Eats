{% load increment %}
{% load common %}
{% load static %}
<main role="main" class="container">
    <h2>Build a Meal</h2><br>
    <h5>&nbsp&nbsp Select a Restaurant</h5>
    <form method="GET">
      <div class="form-group col-md-4">
          <select id="inputState" name="restaurantName" class="form-control" onchange="location = this.value;">
            {% if chosen_restaurant == "All" %}
                <option value ="/calculator/all/" selected>All Restaurants</option>
                 {% for restaurant in restaurants %}
                    <option value="/calculator/{{ restaurant.slug }}/">{{ restaurant.name }}</option>
                 {% endfor %}
            {% else %}
                <option value="/calculator/{{ chosen_restaurant.slug }}/" selected>{{ chosen_restaurant.name }}</option>
                <option value="/calculator/all/">All Restaurants</option>
                {% for restaurant in restaurants %}
                    <option value="/calculator/{{ restaurant.slug }}/">{{ restaurant.name }}</option>
                {% endfor %}
            {% endif %}
          </select>
          {% if chosen_restaurant != "All" %}
            <img src = "/static/main/{{chosen_restaurant.logo.url}}" class="calculator-restaurant-thumbnail">
          {% endif %}
      </div>
      <div class="container">
          <br>
          <h5>Enter Your Order</h5>
        <table id="myTable" class="table order-list">
        <thead>
            <tr>
                <td>#</td>
                <td>Item</td>
                <td>Quantity</td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><h3>1.</h3></td>
                <td class="col-sm-3">
                 <div class="autocomplete">
                    <input type="search" id="myInput1" class="myInput form-control" placeholder="Enter Item" name="itemName1" autocomplete="off" list="itemList">
                     <datalist id="itemList">
                         {% if chosen_restaurant == "All" %}
                             {% for item in items %}
                             <option value="{{ item }} | {{ item.restaurant }}">{{ item }} | {{ item.restaurant }}</option>
                             {% endfor %}
                         {% else %}
                             {% for item in items %}
                             <option value="{{ item }}">{{ item }}</option>
                             {% endfor %}
                         {% endif %}
                     </datalist>
                  </div>
                </td>
                <td class="col-sm-1">
                    <select class="custom-select" name="itemQuantity1">
                    {% for option in options %}
                    <option value="{{ option }}">{{ option }}</option>
                    {% endfor %}
                    </select>
                </td>
                <td class="col-sm-1"><a class="deleteRow"></a>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="5">
                    <input type="button" class="btn btn-lg btn-block " id="addrow" value="Add Item" />
                </td>
            </tr>
        </tfoot>
    </table>
    </div>
    </div>
    <div class="form-row">
        <button type="submit" class="btn btn-primary mb-2">Submit</button>
    </div>
</form>
    <div class="Results">
    <h3>Your Order</h3>
    <table id="orderTable" class="table order">
        <thead>
            <tr>
                <td>#</td>
                <td></td>
                <td>Item</td>
                <td>Quantity</td>
                <td>Calories</td>
                <td>Carbs</td>
                <td>Fat</td>
                <td>Protein</td>
            </tr>
        </thead>
        <tbody>
            {% for itemList in order %}
            <tr>
                <td><b>{{ itemList.0 }}.</b></td>
                <td><img src="/static/main/{{ itemList.8.url }}" class="order-restaurant-thumbnail"></td>
                <td>{{ itemList.1 }}</td>
                <td>{{ itemList.2 }}</td>
                <td>{{ itemList.4 }}</td>
                <td>{{ itemList.5 }}</td>
                <td>{{ itemList.6 }}</td>
                <td>{{ itemList.7 }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</main>
<script>
var counter = 1;
$("#addrow").on("click", function () {
    if (counter < 20){
        counter++;
        var newRow = $("<tr>");
        var cols = "";
        var optionList;
        for (var x = 1; x < 21; x++) {
            optionList += '<option value=' + x + '>' + x + '</option>';
        }
        cols += '<td><h3>' + counter + '.</h3></td>'
        cols += '<td><input type="search" id="myInput' + counter + '" class="myInput form-control" placeholder = "Enter Item" name="itemName' + counter + '" autocomplete="off" list="itemList"></td>';
        cols += '<td><select class = "custom-select" name = "itemQuantity' + counter + '">' + optionList +'</select></td>';
        cols += '<td><input type="button" class="ibtnDel btn btn-md btn-danger "  value="Delete"></td>';

        newRow.append(cols);
        $("table.order-list").append(newRow);

    }
});
$("table.order-list").on("click", ".ibtnDel", function (event) {
    $(this).closest("tr").remove();
    counter -= 1
});
</script>


